"use strict";(self.webpackChunkjet_docs=self.webpackChunkjet_docs||[]).push([[5002],{3594:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>c});var t=i(4848),r=i(8453);const s={},a="Authentication System Documentation",o={id:"auth/authentication",title:"Authentication System Documentation",description:"Table of Contents",source:"@site/docs/auth/authentication.md",sourceDirName:"auth",slug:"/auth/authentication",permalink:"/jet-admin/docs/auth/authentication",draft:!1,unlisted:!1,editUrl:"https://github.com/jet-labs/jet-admin/tree/main/docs/auth/authentication.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Auth",permalink:"/jet-admin/docs/category/auth"},next:{title:"Authorization System Documentation",permalink:"/jet-admin/docs/auth/authorization"}},l={},c=[{value:"Table of Contents",id:"table-of-contents",level:2},{value:"System Overview <a></a>",id:"system-overview-",level:2},{value:"Core Components <a></a>",id:"core-components-",level:2},{value:"Firebase Configuration <a></a>",id:"firebase-configuration-",level:3},{value:"Authentication Flow <a></a>",id:"authentication-flow-",level:3},{value:"Implementation Details <a></a>",id:"implementation-details-",level:2},{value:"Middleware Setup <a></a>",id:"middleware-setup-",level:3},{value:"User Management <a></a>",id:"user-management-",level:3},{value:"Environment Configuration <a></a>",id:"environment-configuration-",level:2},{value:"Security Considerations <a></a>",id:"security-considerations-",level:2},{value:"Protected Routes <a></a>",id:"protected-routes-",level:2},{value:"Production Deployment <a></a>",id:"production-deployment-",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",hr:"hr",input:"input",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"authentication-system-documentation",children:"Authentication System Documentation"}),"\n",(0,t.jsx)(n.h2,{id:"table-of-contents",children:"Table of Contents"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"#authentication-system-documentation",children:"Authentication System Documentation"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#table-of-contents",children:"Table of Contents"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#system-overview-",children:"System Overview "})}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"#core-components-",children:"Core Components "}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#firebase-configuration-",children:"Firebase Configuration "})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#authentication-flow-",children:"Authentication Flow "})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"#implementation-details-",children:"Implementation Details "}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#middleware-setup-",children:"Middleware Setup "})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#user-management-",children:"User Management "})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#environment-configuration-",children:"Environment Configuration "})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#security-considerations-",children:"Security Considerations "})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#protected-routes-",children:"Protected Routes "})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#production-deployment-",children:"Production Deployment "})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h2,{id:"system-overview-",children:["System Overview ",(0,t.jsx)("a",{name:"system-overview"})]}),"\n",(0,t.jsx)(n.p,{children:"Our authentication system integrates Firebase Authentication with custom backend services to provide secure user management. Key features include:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Firebase-based JWT token authentication"}),"\n",(0,t.jsx)(n.li,{children:"Automatic user profile creation"}),"\n",(0,t.jsx)(n.li,{children:"Session management with access/refresh tokens"}),"\n",(0,t.jsx)(n.li,{children:"Role-based access control integration"}),"\n"]}),"\n",(0,t.jsx)(n.mermaid,{value:"sequenceDiagram\r\n    Client->>Firebase: Login with credentials\r\n    Firebase--\x3e>Client: Returns JWT token\r\n    Client->>Backend: API request with JWT\r\n    Backend->>Firebase Admin: Verify token\r\n    Firebase Admin--\x3e>Backend: Token verification result\r\n    Backend->>Database: Get/Create user profile\r\n    Backend--\x3e>Client: User data & session info"}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h2,{id:"core-components-",children:["Core Components ",(0,t.jsx)("a",{name:"core-components"})]}),"\n",(0,t.jsxs)(n.h3,{id:"firebase-configuration-",children:["Firebase Configuration ",(0,t.jsx)("a",{name:"firebase-configuration"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Backend Setup:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'// firebase-key.json\r\n{\r\n  "type": "service_account",\r\n  "project_id": "your-project-id",\r\n  "private_key": "your-private-key",\r\n  "client_email": "firebase-adminsdk@your-project.iam.gserviceaccount.com"\r\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsxs)(n.strong,{children:["Frontend Setup (",(0,t.jsx)(n.code,{children:".env"}),"):"]})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-env",children:"VITE_FIREBASE_API_KEY=your-api-key\r\nVITE_FIREBASE_AUTH_DOMAIN=your-project.firebaseapp.com\r\nVITE_FIREBASE_PROJECT_ID=your-project-id\n"})}),"\n",(0,t.jsx)(n.admonition,{title:"Security Notice",type:"warning",children:(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Never commit service account credentials to version control"}),"\n",(0,t.jsx)(n.li,{children:"Store secrets in environment variables"}),"\n",(0,t.jsx)(n.li,{children:"Rotate keys regularly"}),"\n"]})}),"\n",(0,t.jsxs)(n.h3,{id:"authentication-flow-",children:["Authentication Flow ",(0,t.jsx)("a",{name:"authentication-flow"})]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Client-side Firebase authentication"}),"\n",(0,t.jsx)(n.li,{children:"JWT token verification in backend middleware"}),"\n",(0,t.jsx)(n.li,{children:"User profile synchronization"}),"\n",(0,t.jsx)(n.li,{children:"Session management with dual tokens"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h2,{id:"implementation-details-",children:["Implementation Details ",(0,t.jsx)("a",{name:"implementation-details"})]}),"\n",(0,t.jsxs)(n.h3,{id:"middleware-setup-",children:["Middleware Setup ",(0,t.jsx)("a",{name:"middleware-setup"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Token Verification:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:'authMiddleware.authProvider = async (req, res, next) => {\r\n  const idToken = req.headers.authorization?.split("Bearer ")[1];\r\n  try {\r\n    const decodedIdToken = await firebaseApp.auth().verifyIdToken(idToken);\r\n    req.user = await authService.getUserFromFirebaseID(decodedIdToken.uid);\r\n    next();\r\n  } catch (error) {\r\n    handleAuthError(res, error);\r\n  }\r\n};\n'})}),"\n",(0,t.jsxs)(n.h3,{id:"user-management-",children:["User Management ",(0,t.jsx)("a",{name:"user-management"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Profile Creation:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"authService.createUser = async ({ email, firebaseID }) => {\r\n  return prisma.tblUsers.create({\r\n    data: {\r\n      email,\r\n      firebaseID,\r\n      isActive: true,\r\n      lastLogin: new Date()\r\n    }\r\n  });\r\n};\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h2,{id:"environment-configuration-",children:["Environment Configuration ",(0,t.jsx)("a",{name:"environment-configuration"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Essential Variables:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-env",children:'# Network Security\r\nCORS_WHITELIST="http://localhost:3000,https://prod-domain.com"\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h2,{id:"security-considerations-",children:["Security Considerations ",(0,t.jsx)("a",{name:"security-considerations"})]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Token Security"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"15-minute access token lifetime"}),"\n",(0,t.jsx)(n.li,{children:"100-hour refresh token rotation"}),"\n",(0,t.jsx)(n.li,{children:"HTTP-only cookies for token storage"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Firebase Best Practices"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Enable multi-factor authentication"}),"\n",(0,t.jsx)(n.li,{children:"Implement password complexity policies"}),"\n",(0,t.jsx)(n.li,{children:"Regular security rule audits"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"CORS Configuration"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"app.use(cors({\r\n  origin: process.env.CORS_WHITELIST.split(','),\r\n  methods: ['GET', 'POST', 'PUT', 'DELETE']\r\n}));\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h2,{id:"protected-routes-",children:["Protected Routes ",(0,t.jsx)("a",{name:"protected-routes"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Route Protection Example:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:'router.get("/", authMiddleware.authProvider, authController.getUserInfo);\r\n\r\nrouter.get(\r\n  "/config/:tenantID",\r\n  authMiddleware.authProvider,\r\n  authController.getUserConfig\r\n);\r\n\r\nrouter.post(\r\n  "/config/:tenantID",\r\n  authMiddleware.authProvider,\r\n  authController.updateUserConfig\r\n);\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Error Handling:"})}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Error Code"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"401 Unauthorized"}),(0,t.jsx)(n.td,{children:"Missing or invalid token"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"403 Forbidden"}),(0,t.jsx)(n.td,{children:"Insufficient permissions"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"429 Too Many Requests"}),(0,t.jsx)(n.td,{children:"Rate limit exceeded"})]})]})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h2,{id:"production-deployment-",children:["Production Deployment ",(0,t.jsx)("a",{name:"production-deployment"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Docker Configuration:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'docker run -p 8090:8090 \\\r\n  -e FIREBASE_PROJECT_ID="$PROD_FIREBASE_ID" \\\r\n  -e CORS_WHITELIST="https://prod-domain.com" \\\r\n  backend-image\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Security Checklist:"})}),"\n",(0,t.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Enable HTTPS with HSTS headers"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Configure Firebase Security Rules"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Set up monitoring for auth attempts"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Implement rate limiting"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.p,{children:"This documentation maintains consistency with the authorization system structure while highlighting authentication-specific implementations and security considerations."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>o});var t=i(6540);const r={},s=t.createContext(r);function a(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);